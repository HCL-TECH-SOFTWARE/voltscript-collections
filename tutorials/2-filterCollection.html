
<!-- Elements added to main will be displayed on all pages -->
<!--March2023-->


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="VoltScript Collections: Collection and Map classes for VoltScript">
      
      
      
        <link rel="canonical" href="https://github.com/HCL-TECH-SOFTWARE/voltscript-collections/tutorials/2-filterCollection.html">
      
      
        <link rel="prev" href="1-simpleCollection.html">
      
      
        <link rel="next" href="1-simpleMap.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Filters, Transformers, Custom Comparators and Custom Collections - VoltScript Collections</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../assets/css/style.css">
    
      <link rel="stylesheet" href="../assets/css/style1.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-169645537-2"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-169645537-2",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-169645537-2",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  
    <meta name="robots" content="index, follow" />
  
  <meta property="og:image" content="https://opensource.hcltechsw.com/voltmxgo-documentation/go-thumbnail.png" />

  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#filters-transformers-custom-comparators-and-custom-collections" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
<div>
   <a href="https://www.hcltechsw.com/"> 
  <img width="150" height="30" src="https://help.hcltechsw.com/assets/images/HCL_Software_Logo_White.svg" alt="HCL Logo" target="_blank"></a>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="dropdown">
  <button class="dropbtn">Resources <i class="fa fa-caret-down"></i></button> 
  <div class="dropdown-content">
  <a href="https://support.hcltechsw.com" target="_blank">Customer Support</a>
  <a href="https://hclsoftwareu.hcltechsw.com/volt-mx-go" target="_blank">HCLSoftware U</a>
  <a href="https://developer.ds.hcl-software.com/" target="_blank">Community Forums</a>
  <!--<a href="https://support.hcltechsw.com/community" target="_blank">Community Forums</a>-->

</div>
</div>
  
  <!-- Uncomment the following announcement if you need it -->
  <!--
 <div class="md-banner--feedback" style="display:inline">

  <strong>We value your feedback on this site.</strong> Please report any issues you find <a class="announcement__link" href="https://github.com/HCL-TECH-SOFTWARE/digital-experience/issues">via Github</a>. 
  
  <div class="md-banner--feedback">Looking for v8.5 or v9.0? <a class="announcement__link"  href="https://help.hcltechsw.com/digital-experience/9.5/welcome_hcl_dx.html">Check the legacy Help Center.</a>
</div>  
</div>
-->

</div>

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="VoltScript Collections" class="md-header__button md-logo" aria-label="VoltScript Collections" data-md-component="logo">
      
  <img src="../assets/images/VoltMXGoLogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VoltScript Collections
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Filters, Transformers, Custom Comparators and Custom Collections
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/HCL-TECH-SOFTWARE/voltscript-collections/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    HCL-TECH_SOFTWARE/voltscript-collections
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../whatsnew.html" class="md-tabs__link">
        
  
  
    
  
  What's new

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="index.html" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../howto/index.html" class="md-tabs__link">
          
  
  
    
  
  How-to guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../topicguides/index.html" class="md-tabs__link">
          
  
  
    
  
  Topic guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../references/index.html" class="md-tabs__link">
          
  
  
    
  
  References

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="VoltScript Collections" class="md-nav__button md-logo" aria-label="VoltScript Collections" data-md-component="logo">
      
  <img src="../assets/images/VoltMXGoLogo.png" alt="logo">

    </a>
    VoltScript Collections
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/HCL-TECH-SOFTWARE/voltscript-collections/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    HCL-TECH_SOFTWARE/voltscript-collections
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../whatsnew.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What's new
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1-simpleCollection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple Collection Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Filters, Transformers, Custom Comparators and Custom Collections
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="2-filterCollection.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Filters, Transformers, Custom Comparators and Custom Collections
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#person-class" class="md-nav__link">
    <span class="md-ellipsis">
      Person Class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-basic-person-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Loading Basic Person Collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-and-comparator" class="md-nav__link">
    <span class="md-ellipsis">
      Filter and Comparator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter and Comparator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#personfilter" class="md-nav__link">
    <span class="md-ellipsis">
      PersonFilter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#personcomparator" class="md-nav__link">
    <span class="md-ellipsis">
      PersonComparator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passing-to-sorted-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Passing to Sorted Collection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformer-and-custom-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Transformer and Custom Collection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transformer and Custom Collection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#persontransformer" class="md-nav__link">
    <span class="md-ellipsis">
      PersonTransformer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#personaltcollection" class="md-nav__link">
    <span class="md-ellipsis">
      PersonAltCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-the-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      Performing the Transformation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#printing-out-the-result" class="md-nav__link">
    <span class="md-ellipsis">
      Printing out the Result
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1-simpleMap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple map examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2-filterMap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Filters, Transformers, Custom Comparators
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../howto/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    How-to guides
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            How-to guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/create.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create a Collection / Map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/interrogate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interrogate the Collection / Map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/iterate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iterate a Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/stack_queue.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulate a stack / queue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/comparator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create your own comparator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/override.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extend Collections / Maps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/filter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Filter Collections / Maps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/transform.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transform Collections / Maps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/archipelago.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use dependency management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/errorhandling.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Error Handling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../topicguides/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Topic guides
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Topic guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topicguides/why.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why VoltScript Collections and Maps?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topicguides/valid.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Valid Content Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topicguides/sorting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sorting and Comparators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topicguides/pair.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pair Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topicguides/size_and_performance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding Collection Sorting Performance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../references/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/apidoc/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/testreports/TestCollections/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Collection test report
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/testreports/TestMaps/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Map test report
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#person-class" class="md-nav__link">
    <span class="md-ellipsis">
      Person Class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-basic-person-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Loading Basic Person Collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-and-comparator" class="md-nav__link">
    <span class="md-ellipsis">
      Filter and Comparator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter and Comparator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#personfilter" class="md-nav__link">
    <span class="md-ellipsis">
      PersonFilter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#personcomparator" class="md-nav__link">
    <span class="md-ellipsis">
      PersonComparator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passing-to-sorted-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Passing to Sorted Collection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformer-and-custom-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Transformer and Custom Collection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transformer and Custom Collection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#persontransformer" class="md-nav__link">
    <span class="md-ellipsis">
      PersonTransformer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#personaltcollection" class="md-nav__link">
    <span class="md-ellipsis">
      PersonAltCollection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-the-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      Performing the Transformation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#printing-out-the-result" class="md-nav__link">
    <span class="md-ellipsis">
      Printing out the Result
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="filters-transformers-custom-comparators-and-custom-collections">Filters, Transformers, Custom Comparators and Custom Collections</h1>
<h2 id="person-class">Person Class</h2>
<p>Imagine you have a class like so:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kd">Class</span><span class="w"> </span><span class="nc">Person</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="k">Public</span><span class="w"> </span><span class="n">firstName</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nb">String</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="k">Public</span><span class="w"> </span><span class="n">lastName</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nb">String</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="k">Public</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Integer</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">End</span><span class="w"> </span><span class="k">Class</span>
</code></pre></div>
<h2 id="loading-basic-person-collection">Loading Basic Person Collection</h2>
<p>You can populate a collection like so:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">personColl</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Collection</span><span class="p">(</span><span class="s2">&quot;PERSON&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Nothing</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Dennis&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">84</span><span class="p">))</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Denise&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">82</span><span class="p">))</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Andrew&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">))</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Fred&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">))</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Frances&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">67</span><span class="p">))</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">))</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Jane&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">))</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Johnathan&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">))</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Janet&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Ken&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">))</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Karen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">39</span><span class="p">))</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Bill&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="p">))</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">17</span><span class="p">))</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="k">Call</span><span class="w"> </span><span class="n">personColl</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">createPerson</span><span class="p">(</span><span class="s2">&quot;Ben&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span>
</code></pre></div>
<p>On the first line, you create a Collection that will only accept <code>Person</code> objects, but will be non-unique and unsorted.</p>
<p>Imagine the feed of data you have is based on a family tree format: Dennis and Denise had twins - William and Fred; William did not marry, but Fred married Frances and had two sons, John and Ken; John married Jane and had two children; Ken married Karen and had three children.</p>
<p>You add each Person <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr> in turn to the Collection. For brevity of code, you do this using a function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kd">Function</span><span class="w"> </span><span class="nf">createPerson</span><span class="p">(</span><span class="n">firstName</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">lastName</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Integer</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Person</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="k">Set</span><span class="w"> </span><span class="n">createPerson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Person</span><span class="p">()</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="n">createPerson</span><span class="p">.</span><span class="n">firstName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firstName</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="n">createPerson</span><span class="p">.</span><span class="n">lastName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lastName</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">    </span><span class="n">createPerson</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="c1">&#39; (1)!</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
</code></pre></div>
<ol>
<li>The Person <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr>, assigned to a variable with the same name as the function, is implicitly returned at the end of the function.</li>
</ol>
<h2 id="filter-and-comparator">Filter and Comparator</h2>
<p>You now have a Collection of Person objects based on insertion order. It may be that our code needs to perform some function with those or generate some reporting. But imagine at some point in the processing, you then want to filter out those Person entries with an age greater of 80 or more, and sort the rest on age, then first name.</p>
<h3 id="personfilter">PersonFilter</h3>
<p>To filter out entries, you extend the CollectionFilter class with a PersonFilter class. The CollectionFilter class has an <abbr title="&quot;New&quot; method that takes no arguments, i.e. Sub New()">empty constructor</abbr>, so you don't need to specify the New method. But you do want to override the <code>filter()</code> method. In this case, you want to return true only if the age is less than 80.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kd">Class</span><span class="w"> </span><span class="nc">PersonFilter</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">CollectionFilter</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="kd">Function</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">source</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Variant</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Boolean</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">        </span><span class="n">Return</span><span class="w"> </span><span class="nb">CInt</span><span class="p">(</span><span class="n">source</span><span class="p">.</span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">80</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="k">End</span><span class="w"> </span><span class="k">Class</span>
</code></pre></div>
<h3 id="personcomparator">PersonComparator</h3>
<p>The sort options for a Collection can't be changed once it's created, and the <code>filter()</code> method uses the same settings as the Collection it's filtering. But you can add the entries to a new Collection that's sorted. To sort, you need to create a custom Comparator.</p>
<p>This can be done with:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kd">Class</span><span class="w"> </span><span class="nc">PersonComparator</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Comparator</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="kd">Sub</span><span class="w"> </span><span class="nf">New</span><span class="p">(</span><span class="n">isDescending</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Boolean</span><span class="p">)</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">        </span><span class="c1">&#39;Nothing needed here</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="k">End</span><span class="w"> </span><span class="k">Sub</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">    </span><span class="kd">Function</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="n">source</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Variant</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Variant</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Integer</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">        </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">person1</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Person</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">        </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">person2</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Person</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">        </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">check</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Integer</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">        </span><span class="k">Set</span><span class="w"> </span><span class="n">person1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">        </span><span class="k">Set</span><span class="w"> </span><span class="n">person2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">        </span><span class="k">If</span><span class="w"> </span><span class="p">(</span><span class="n">person1</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">person2</span><span class="p">.</span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">            </span><span class="n">Return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">        </span><span class="k">ElseIf</span><span class="w"> </span><span class="p">(</span><span class="n">person1</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">person2</span><span class="p">.</span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">            </span><span class="n">Return</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">        </span><span class="k">Else</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">            </span><span class="n">check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StrCompare</span><span class="p">(</span><span class="n">Person1</span><span class="p">.</span><span class="n">firstName</span><span class="p">,</span><span class="w"> </span><span class="n">person2</span><span class="p">.</span><span class="n">firstName</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">            </span><span class="k">If</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StrCompare</span><span class="p">(</span><span class="n">Person1</span><span class="p">.</span><span class="n">lastName</span><span class="p">,</span><span class="w"> </span><span class="n">person2</span><span class="p">.</span><span class="n">lastName</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">            </span><span class="n">Return</span><span class="w"> </span><span class="n">check</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">        </span><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">    </span><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">    </span><span class="kd">Function</span><span class="w"> </span><span class="nf">equals</span><span class="p">(</span><span class="n">source</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Variant</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Variant</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Boolean</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="w">        </span><span class="k">If</span><span class="w"> </span><span class="n">compare</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span><span class="n">Return</span><span class="w"> </span><span class="no">True</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="w">    </span><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="k">End</span><span class="w"> </span><span class="k">Class</span>
</code></pre></div></td></tr></table></div>
<p>The Comparator class doesn't have an <abbr title="&quot;New&quot; method that takes no arguments, i.e. Sub New()">empty constructor</abbr>, so you need to explicitly add the <abbr title="&quot;New&quot; method, used to create a new instance of a class">constructor</abbr>, from line 3. However, both constructors have the same arguments, so the code is very simple and it will automatically call the <code>Comparator</code> class's <code>New</code> method.</p>
<p>From line 7, you override the <code>compare</code> method. This method takes two parameters - <code>source</code>, the value being inserted, and <code>target</code>, the value it's being compared to. On lines 12 and 13, you explicitly cast source and target as Person objects. This means the runtime automatically understands the data type of the properties, so you don't need to explicitly convert to doubles or strings.</p>
<p>If the ages are different, it's simple. On lines 14 and 15, we return -1 ("before") if the age on the source Person <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr> is less than the target Person <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr>. On lines 16 and 17, you return 1 ("after") if the age of the source Person <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr> is greater than the target Person <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr>. The <code>compare</code> method is used for uniqueness as well as sort order, so you can't just return 0 in all other cases. you need to check the first name and, if that's still 0, check the last name.</p>
<p>Because we're going to use the Comparator for a unique collection, we need to override the <code>equals()</code> function to return <code>True</code> if we find an exact match. The <code>compare()</code> function returns an integer where 0 means it's an exact match, so we can reuse that function.</p>
<h3 id="passing-to-sorted-collection">Passing to Sorted Collection</h3>
<p>Now you are ready to filter the Collection and pass it to a sorted Collection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Running a filter iterates the source Collection and returns a new Collection. Adding the resulting (filtered) Collection to a new sorted Collection also requires iterating the Collection. For a small Collection, the performance overhead will be minimal and there may be benefits for debugging in having multiple steps.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="w">    </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">PersonFilter</span><span class="p">()</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">    </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">compar</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">PersonComparator</span><span class="p">(</span><span class="no">false</span><span class="p">)</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">sortedPersonColl</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Collection</span><span class="p">(</span><span class="s2">&quot;PERSON&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">compar</span><span class="p">,</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="no">True</span><span class="p">)</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">    </span><span class="k">Call</span><span class="w"> </span><span class="n">sortedPersonColl</span><span class="p">.</span><span class="n">addAll</span><span class="p">(</span><span class="n">personColl</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="nb">filter</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<p>On line 1, you create an instance of the PersonFilter. On line 2 you create an instance of the PersonComparator, telling it to sort in ascending order (youngest to oldest, then first name A-Z). On line 3, you create a sorted, non-unique Collection passing in the PersonComparator for sorting and identifying uniques.</p>
<p>Finally, on line 5, you perform the process. <code>personColl.filter(filter)</code> is called first, returning a filtered Collection. The resulting Collection is then passed to <code>Call sortedPersonColl.addAll()</code>.</p>
<h2 id="transformer-and-custom-collection">Transformer and Custom Collection</h2>
<p>Imagine you want to output summary data about the people, hiding their actual age but just defining age groups - child, young person, adult, pensioner. Imagine the code already has a class for Person information in this format, like so:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kd">Class</span><span class="w"> </span><span class="nc">PersonAlt</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="k">Public</span><span class="w"> </span><span class="n">fullName</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nb">String</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="k">Public</span><span class="w"> </span><span class="n">ageRange</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nb">String</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="k">End</span><span class="w"> </span><span class="k">Class</span>
</code></pre></div>
<p>A CollectionTransformer can convert from one class to the other.</p>
<h3 id="persontransformer">PersonTransformer</h3>
<p>You just need to create a PersonTransformer extending the CollectionTransformer class, like so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kd">Class</span><span class="w"> </span><span class="nc">PersonTransformer</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">CollectionTransformer</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="kd">Function</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="n">source</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Variant</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Variant</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">        </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">newPerson</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PersonAlt</span><span class="p">()</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">        </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">oldPerson</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Person</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">        </span><span class="k">Set</span><span class="w"> </span><span class="n">oldPerson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">        </span><span class="n">newPerson</span><span class="p">.</span><span class="n">fullname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oldPerson</span><span class="p">.</span><span class="n">firstName</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">oldPerson</span><span class="p">.</span><span class="n">lastName</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">        </span><span class="k">Select</span><span class="w"> </span><span class="k">Case</span><span class="w"> </span><span class="n">oldPerson</span><span class="p">.</span><span class="n">age</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">            </span><span class="k">Case</span><span class="w"> </span><span class="ow">Is</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">                </span><span class="n">newPerson</span><span class="p">.</span><span class="n">ageRange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Child&quot;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">            </span><span class="k">Case</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="mi">30</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">                </span><span class="n">newPerson</span><span class="p">.</span><span class="n">ageRange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Young Person&quot;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">            </span><span class="k">Case</span><span class="w"> </span><span class="ow">Is</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">60</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">                </span><span class="n">newPerson</span><span class="p">.</span><span class="n">ageRange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Pensioner&quot;</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">            </span><span class="k">Case</span><span class="w"> </span><span class="k">Else</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="w">                </span><span class="n">newPerson</span><span class="p">.</span><span class="n">ageRange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Adult&quot;</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">        </span><span class="k">End</span><span class="w"> </span><span class="k">Select</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">        </span><span class="n">Return</span><span class="w"> </span><span class="n">newPerson</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">    </span><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="k">End</span><span class="w"> </span><span class="k">Class</span>
</code></pre></div></td></tr></table></div>
<p>The CollectionTransformer has an <abbr title="&quot;New&quot; method that takes no arguments, i.e. Sub New()">empty constructor</abbr>, so we don't need to include the <code>Sub New</code>. We just need to extend the <code>transform</code> function, from line 3. This takes an incoming value as a Variant (<code>source</code>) and returns the transformed value as a Variant.</p>
<p>For readability, you create a <code>newPerson</code> on line 4 using the <code>PersonAlt</code> class you need to output. And you declare an <code>oldPerson</code> <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr> on line 5 as the <code>Person</code> class you expect incoming. On line 7, you explicitly cast <code>source</code> into the <code>oldPerson</code> <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr>.</p>
<p>On line 8, you set the <code>fullName</code> property.</p>
<p>From line 9, you have a <code>Select Case</code> statement to convert age to a textual range value. Lines 10 and 14 use <code>Is</code> with a comparison operator, to identify children or pensioners. Line 12 uses a range expression, which is inclusive, to pick up values from and including 16 through to and including 30. Line 16 then picks up all remaining ages. The <code>ageRange</code> variable in <code>newPerson</code> is set accordingly. Finally, on line 19, you return the newPerson <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr>.</p>
<h3 id="personaltcollection">PersonAltCollection</h3>
<p>You could just use a normal Collection class, extracting the instance of <code>PersonAlt</code> using <code>getNthElementRaw()</code>. But to show full functionality, you will create a custom Collection class:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kd">Class</span><span class="w"> </span><span class="nc">PersonAltCollection</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Collection</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="kd">Sub</span><span class="w"> </span><span class="nf">New</span><span class="p">(),</span><span class="w"> </span><span class="n">Collection</span><span class="p">(</span><span class="s2">&quot;PERSONALT&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Nothing</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">        </span><span class="c1">&#39; Nothing to do</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span><span class="k">End</span><span class="w"> </span><span class="k">Sub</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="kd">Function</span><span class="w"> </span><span class="nf">getNthElement</span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Long</span><span class="p">)</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">PersonAlt</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">        </span><span class="n">Return</span><span class="w"> </span><span class="n">getNthElementRaw</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="k">End</span><span class="w"> </span><span class="k">Class</span>
</code></pre></div>
<p>The <abbr title="&quot;New&quot; method, used to create a new instance of a class">constructor</abbr> from line 3 is unusual. The incoming <abbr title="&quot;New&quot; method, used to create a new instance of a class">constructor</abbr> takes no arguments, but the <abbr title="&quot;New&quot; method, used to create a new instance of a class">constructor</abbr> of the base <code>Collection</code> class requires arguments. The correct syntax for this is <code>Sub</code> plus incoming <abbr title="&quot;New&quot; method, used to create a new instance of a class">constructor</abbr> <code>New()</code>, then a comma and the base class name followed by the arguments to pass <code>, Collection("PERSONALT", Nothing, False, False)</code>. The <abbr title="&quot;New&quot; method, used to create a new instance of a class">constructor</abbr> doesn't need to do anything else, so there is no additional code.</p>
<p>You then add a <code>getNthElement()</code> function from line 7, which will explicitly return an instance of the <code>PersonAlt</code> class. Because you're returning an <abbr title="instance of a class, created with syntax &quot;Dim foo as New Bar&quot;">object</abbr>, you need the <code>Set</code> keyword, then you just need to return the value from the base class's <code>getNthElementRaw()</code> function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because you're calling a different method in the base class, you can just use its name. There may be scenarios where you want to overload a method from the base class, such as <code>add()</code>, to run some code and then call the base class's <code>add()</code> function. This can be done using <em>baseClassName</em>..<em>methodName</em>, i.e. <code>Call Collection..add(source)</code></p>
</div>
<h3 id="performing-the-transformation">Performing the Transformation</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>transform</code> function also iterates the source Collection and adds elements to the new target Collection. If the target Collection is sorted, it will still use a Comparator to sort the incoming value against the values already in the target Collection.</p>
</div>
<p>You perform the transformation like so:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">personAltTransformer</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">PersonTransformer</span><span class="p">()</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">personAltColl</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">PersonAltCollection</span><span class="p">()</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="k">Call</span><span class="w"> </span><span class="n">sortedPersonColl</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">personAltTransformer</span><span class="p">,</span><span class="w"> </span><span class="n">personAltColl</span><span class="p">)</span>
</code></pre></div>
<p>You create an instance of the <code>PersonTransformer</code> and an instance of the <code>PersonAltCollection</code> class. Then we pass these into the <code>transform</code> function of the resulting <code>sortedPersonColl</code> from the filter and sort. Because <code>addAll()</code> is a fluent function, we can perform the whole thing in a single line: <code>Call sortedPersonColl.addAll(personColl.filter(filter)).transform(personAltTransformer, personAltColl)</code>.</p>
<h2 id="printing-out-the-result">Printing out the Result</h2>
<p>Finally, you can print out the result like so:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">Long</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">altPerson</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">PersonAlt</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">Do</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="k">Set</span><span class="w"> </span><span class="n">altPerson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">personAltColl</span><span class="p">.</span><span class="n">getNthElement</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="n">Print</span><span class="w"> </span><span class="n">altPerson</span><span class="p">.</span><span class="n">fullName</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot; - &quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">altPerson</span><span class="p">.</span><span class="n">ageRange</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="k">Loop</span><span class="w"> </span><span class="k">While</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">personAltColl</span><span class="p">.</span><span class="n">elementCount</span>
</code></pre></div>
<p>After declaring variables you use <code>Do...Loop While</code> to iterate the Collection and print out the full name and age range.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are quite a few iterations of the initial Collection here. The code could be streamlined, if nothing more than the incoming Collection and outgoing printout were required. But the example shows using the broad variety of the Collection class functionality.</p>
</div>
<p><a href="../example_code/people-coll.txt" target="_new">Example Code</a></p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023-2025, HCL America, Inc. | <a href="https://www.hcl-software.com/legal/privacy" target="_blank">Privacy Statement</a> | <a href="https://www.hcl-software.com/legal/terms-use" target="_blank">Terms of Use</a> <br/> <a href="#__consent">Change cookie settings</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/HCL-TECH-SOFTWARE" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.indexes", "navigation.top", "navigation.instant", "navigation.sections", "search.highlight", "search.share", "search.suggest", "content.code.annotate", "content.code.copy", "content.tooltips"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>